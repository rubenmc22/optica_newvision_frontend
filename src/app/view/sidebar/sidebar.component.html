<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>New Vision | 칍ptica</title>
  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="./../../../assets/adminlte/plugins/fontawesome-free/css/all.min.css">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <!-- overlayScrollbars -->
  <link rel="stylesheet" href="./../../../assets/adminlte/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="./../../../assets/adminlte/dist/css/adminlte.min.css">
</head>

<body class="hold-transition sidebar-mini layout-fixed layout-navbar-fixed">
  <!-- Site wrapper -->
  <div class="wrapper">
    <!-- Navbar con Estilo Pacientes -->
    <nav class="main-header navbar navbar-expand navbar-white navbar-light">
      <!-- Left navbar links -->
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-widget="pushmenu" href="#" role="button">
            <i class="fas fa-bars"></i>
          </a>
        </li>
      </ul>

      <!-- Centro: Tasas de cambio -->
      <div class="navbar-tasas mx-auto">
        <div class="tasas-container">
          <span class="tasa-item">
            <i class="bi bi-currency-dollar"></i>
            <strong>USD:</strong> {{ tasaDolar | number:'1.2-2' }} Bs
          </span>
          <span class="tasa-divider">|</span>
          <span class="tasa-item">
            <i class="bi bi-currency-euro"></i>
            <strong>EUR:</strong> {{ tasaEuro | number:'1.2-2' }} Bs
          </span>
        </div>
      </div>

      <!-- Right navbar links con Dropdown de Usuario -->
      <ul class="navbar-nav ml-auto">
        <li class="nav-item dropdown user-menu">
          <a class="nav-link dropdown-toggle user-dropdown-toggle" href="#" role="button" id="userDropdown"
            data-bs-toggle="dropdown" aria-expanded="false" (click)="toggleUserDropdown($event)">
            <div class="user-info-header">
              <img [src]="profileImage" class="user-img-header" alt="User Image" (error)="handleImageError($event)">
              <span class="user-name-header">{{ userName }}</span>
              <i class="bi bi-chevron-down dropdown-arrow"></i>
            </div>
          </a>
          <ul class="dropdown-menu dropdown-menu-end user-dropdown-menu" aria-labelledby="userDropdown">
            <li>
              <a class="dropdown-item"  (click)="goToMyProfile()">
                <i class="bi bi-person me-2"></i>Mi Perfil
              </a>
            </li>
            <li>
              <a class="dropdown-item"  (click)="goToExchangeRate()">
                <i class="bi bi-currency-exchange me-2"></i>Tipo de cambio
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>
            <li>
              <a class="dropdown-item logout-option" href="#" (click)="openLogoutModal($event)">
                <i class="bi bi-box-arrow-right me-2"></i>Cerrar Sesi칩n
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </nav>

    <!-- Sidebar con Estilo Pacientes -->
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
      <!-- User Panel -->
      <div class="sidebar-user">
        <div class="user-avatar">
          <img [src]="profileImage" class="avatar-image" alt="User Image" (error)="handleImageError($event)">
        </div>
        <div class="user-info">
          <div class="user-name">{{ userName }}</div>
          <div class="user-role">{{ userRoleName }}</div>
          <div class="user-sede">
            <i class="bi bi-geo-alt"></i>
            {{ sedeActual | titlecase }}
          </div>
        </div>
      </div>

      <!-- Sidebar Menu -->
      <div class="sidebar" style="margin-top: 1rem !important;">
        <nav class="mt-0">
          <ul class="nav nav-pills nav-sidebar flex-column" data-accordion="false">
            <li *ngFor="let menu of filteredMenu" class="nav-item" [ngClass]="{
              'menu-open': selectedMenuLabel === menu.label,
              'menu-expanded': selectedMenuLabel === menu.label && menu.submenu
            }">

              <!-- Men칰 sin submen칰 -->
              <a *ngIf="!menu.submenu" [routerLink]="menu.underConstruction ? null : menu.routerLink" class="nav-link"
                [matTooltip]="menu.underConstruction ? 'M칩dulo en desarrollo 游뚾' : null" matTooltipPosition="right"
                [matTooltipDisabled]="!menu.underConstruction" (click)="onMenuClick($event, menu)" [ngClass]="{
                  'active': selectedMenuLabel === menu.label,
                  'disabled': menu.underConstruction
                }">
                <i *ngIf="menu.icon" [class]="menu.icon"></i>
                <p>
                  {{ menu.label }}
                  <span *ngIf="menu.underConstruction" class="menu-badge">游뚾</span>
                </p>
              </a>

              <!-- Men칰 con submen칰 activo -->
              <a *ngIf="menu.submenu && !menu.underConstruction" class="nav-link"
                [ngClass]="{ 'active': selectedMenuLabel === menu.label }" role="button" tabindex="0"
                (click)="toggleSubmenu($event)">
                <i [class]="menu.icon"></i>
                <p>
                  {{ menu.label }}
                  <i class="right fas fa-angle-left arrow-icon"></i>
                </p>
              </a>

              <!-- Men칰 con submen칰 en desarrollo -->
              <span *ngIf="menu.submenu && menu.underConstruction" class="nav-link disabled"
                [matTooltip]="'M칩dulo en desarrollo 游뚾'" matTooltipPosition="right">
                <i [class]="menu.icon"></i>
                <p>
                  {{ menu.label }}
                  <span class="menu-badge">游뚾</span>
                </p>
              </span>

              <!-- Submen칰s -->
              <ul *ngIf="menu.submenu && !menu.underConstruction" class="nav nav-treeview submenu"
                [ngClass]="{ 'show': selectedMenuLabel === menu.label }">
                <li *ngFor="let sub of menu.submenu" class="nav-item">
                  <a [routerLink]="sub.underConstruction ? null : sub.routerLink" class="nav-link"
                    [matTooltip]="sub.underConstruction ? 'M칩dulo en desarrollo 游뚾' : null" matTooltipPosition="right"
                    [matTooltipDisabled]="!sub.underConstruction"
                    (click)="onMenuClick($event, buildSubmenuItem(sub, menu.label))"
                    [ngClass]="{ 'active': selectedSubmenuLabel === sub.label }">
                    <i class="bi bi-dot nav-icon"></i>
                    <p>{{ sub.label }}</p>
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
    </aside>

    <!-- Content Wrapper -->
    <section class="content-wrapper">
      <div class="container-fluid">
        <ng-container *ngIf="loader.loading$ | async">
          <app-global-loader></app-global-loader>
        </ng-container>
        <router-outlet></router-outlet>
      </div>
    </section>

    <!-- Footer con Estilo Pacientes -->
    <footer class="main-footer" style="background-color:  #34495e !important;">
      <div class="footer-content">
        <span class="copyright">&copy; 2025 칍ptica New Vision Lens 2020</span>
        <span class="version">v1.0</span>
      </div>
    </footer>
  </div>

  <!-- Modal para Cierre de Sesi칩n con Estilo Pacientes -->
  <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content logout-modal">
        <div class="modal-header-moderno">
          <div class="modal-header-content">
            <div class="modal-icon">
              <i class="bi bi-box-arrow-right"></i>
            </div>
            <div class="modal-title-content">
              <h5 class="modal-title">Cerrar Sesi칩n</h5>
              <p class="modal-subtitle">Confirmar salida del sistema</p>
            </div>
          </div>
          <button type="button" class="btn-close-moderno" data-bs-dismiss="modal" aria-label="Close">
            <i class="bi bi-x"></i>
          </button>
        </div>
        <div class="modal-body-moderno">
          <div class="form-moderno text-center py-4">
            <i class="bi bi-question-circle text-warning mb-3" style="font-size: 3rem;"></i>
            <p class="mb-0" style="color: #495057; font-size: 1.1rem;">
              쮼st치s seguro de que deseas salir del sistema?
            </p>
          </div>
        </div>
        <div class="modal-footer-moderno">
          <button type="button" class="btn-secondary-moderno" data-bs-dismiss="modal">
            <i class="bi bi-x-circle me-2"></i>Cancelar
          </button>
          <button type="button" class="btn-primary-moderno" (click)="confirmLogout()" data-bs-dismiss="modal">
            <i class="bi bi-box-arrow-right me-2"></i>Salir
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="./../../../assets/adminlte/plugins/jquery/jquery.min.js"></script>
  <script src="./../../../assets/adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="./../../../assets/adminlte/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
  <script src="./../../../assets/adminlte/dist/js/adminlte.min.js"></script>
</body>

</html>